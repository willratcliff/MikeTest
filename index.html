<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mike Wang's Sarracenia - Premium Carnivorous Plants</title>
    
    <!-- Google Analytics (Commented out - replace G-XXXXXXXXXX with real tracking ID) -->
    <!-- 
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    -->
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            line-height: 1.6;
            color: #2c3e2d;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Styles */
        header {
            background: rgba(44, 62, 45, 0.95);
            backdrop-filter: blur(10px);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .hamburger-menu {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            transition: color 0.3s ease;
        }

        .hamburger-menu:hover {
            color: #7cb342;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #7cb342;
            text-decoration: none;
            cursor: pointer;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .cart-icon {
            position: relative;
            cursor: pointer;
            font-size: 2rem;
            transition: transform 0.3s ease;
        }

        .cart-icon:hover {
            transform: scale(1.1);
        }

        #cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff4444;
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 0.8rem;
            min-width: 18px;
            text-align: center;
            display: none;
        }

        /* Navigation Menu Styles */
        .nav-menu {
            position: fixed;
            top: 0;
            left: -320px;
            width: 320px;
            height: 100vh;
            background: rgba(44, 62, 45, 0.98);
            backdrop-filter: blur(10px);
            transition: left 0.3s ease;
            z-index: 1001;
            padding: 2rem 0;
            overflow-y: auto;
        }

        .nav-menu.open {
            left: 0;
        }

        .nav-menu-header {
            padding: 0 2rem 1rem 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 1rem;
        }

        .nav-menu-title {
            color: #7cb342;
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0;
        }

        .nav-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
        }

        .nav-close:hover {
            color: #7cb342;
        }

        .nav-menu ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .nav-menu li {
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .nav-menu a {
            display: block;
            padding: 1rem 2rem;
            color: #e8f5e8;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-menu a:hover, .nav-menu a.active {
            background: rgba(124, 179, 66, 0.2);
            color: #7cb342;
            border-left: 4px solid #7cb342;
            padding-left: calc(2rem - 4px);
        }

        .nav-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .nav-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        /* Hide old navigation */
        nav {
            display: none;
        }

        /* Image Modal Styles */
        .image-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .image-modal.show {
            display: flex;
        }

        .image-modal-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
            background: white;
            border-radius: 10px;
            padding: 1rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .image-modal img {
            width: 100%;
            height: auto;
            max-width: 80vw;
            max-height: 70vh;
            object-fit: contain;
            border-radius: 8px;
        }

        .image-modal-close {
            position: absolute;
            top: -10px;
            right: -10px;
            background: #ff4444;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }

        .image-modal-close:hover {
            background: #cc0000;
        }

        .image-modal-title {
            text-align: center;
            margin-bottom: 1rem;
            color: #2c3e2d;
            font-size: 1.2rem;
            font-weight: bold;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .cart-icon-container {
            position: relative;
            cursor: pointer;
        }

        /* Search and Sort Controls */
        .category-controls {
            display: flex;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(124, 179, 66, 0.2);
        }

        .stock-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            font-size: 0.9rem;
            color: #2c3e2d;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .stock-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .stock-toggle input[type="checkbox"] {
            margin: 0;
            cursor: pointer;
        }

        .search-box {
            padding: 0.8rem 1rem;
            border: 2px solid #7cb342;
            border-radius: 25px;
            font-size: 1rem;
            width: 300px;
            max-width: 100%;
            outline: none;
            transition: all 0.3s ease;
        }

        .search-box:focus {
            border-color: #5a8f2a;
            box-shadow: 0 0 10px rgba(124, 179, 66, 0.3);
        }

        .sort-controls {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .sort-btn {
            padding: 0.8rem 1.2rem;
            background: #7cb342;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .sort-btn:hover {
            background: #5a8f2a;
            transform: translateY(-2px);
        }

        .sort-btn.active {
            background: #2c3e2d;
        }

        .results-count {
            color: #5a8f2a;
            font-weight: bold;
            margin-left: 1rem;
        }

        .contact-info {
            font-size: 0.9rem;
            text-align: right;
            line-height: 1.4;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)),
                        url('https://live.staticflickr.com/65535/53472378779_cda76e39c0_c.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            color: white;
            padding: 4rem 0;
            text-align: center;
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .hero p {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-subtitle {
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }

        .announcement {
            background: rgba(124, 179, 66, 0.9);
            padding: 1rem 2rem;
            border-radius: 10px;
            font-weight: bold;
            font-size: 1.1rem;
            display: inline-block;
            margin-top: 1rem;
        }

        /* Category Grid */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-bottom: 4rem;
        }

        .category-card {
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            color: white;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            text-decoration: none;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            position: relative;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.4));
            border-radius: 15px;
            z-index: 1;
        }

        .category-card > * {
            position: relative;
            z-index: 2;
        }

        .category-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .category-card:hover::before {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.3));
        }

        .category-title {
            font-size: 1.8rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .category-description {
            font-size: 1rem;
            margin-bottom: 1rem;
            opacity: 0.9;
        }

        .category-count {
            font-size: 1.1rem;
            font-weight: bold;
            color: #7cb342;
        }

        /* About Section */
        .about {
            background: rgba(255, 255, 255, 0.9);
            padding: 3rem;
            border-radius: 15px;
            margin: 3rem 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .about h2 {
            color: #2c3e2d;
            margin-bottom: 1.5rem;
            font-size: 2.5rem;
        }

        .about p {
            margin-bottom: 1.5rem;
            color: #555;
            font-size: 1.1rem;
        }

        .highlight {
            background: rgba(124, 179, 66, 0.1);
            padding: 1.5rem;
            border-left: 4px solid #7cb342;
            margin: 2rem 0;
            border-radius: 5px;
        }

        .highlight-image {
            float: right;
            max-width: 250px;
            width: 100%;
            height: auto;
            border-radius: 8px;
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }

        @media (max-width: 768px) {
            .highlight-image {
                float: none;
                display: block;
                max-width: 200px;
                margin: 0 auto 1rem auto;
            }
        }

        /* Loading Styles */
        .loader-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(44, 62, 45, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            color: white;
            font-family: Georgia, serif;
        }

        .loader-content {
            text-align: center;
            background: rgba(0, 0, 0, 0.8);
            padding: 2rem;
            border-radius: 10px;
            border: 2px solid #7cb342;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #7cb342;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Section Title */
        .section-title {
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 3rem;
            color: #2c3e2d;
        }

        /* Page Section Styles */
        .page-section {
            display: none;
            min-height: calc(100vh - 200px);
        }

        .page-section.active {
            display: block;
        }

        /* Plant Grid */
        .plant-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-bottom: 4rem;
        }

        .plant-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 2px solid rgba(124, 179, 66, 0.1);
        }

        .plant-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            border-color: #7cb342;
        }

        .plant-image {
            height: 280px;
            position: relative;
            overflow: hidden;
            background: linear-gradient(45deg, #7cb342, #8bc34a);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .plant-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            object-position: center;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .plant-image img:hover {
            transform: scale(1.05);
        }

        .plant-image.placeholder {
            font-size: 4rem;
            color: white;
        }

        .plant-image::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.1) 100%);
            z-index: 1;
        }

        .status-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            z-index: 2;
            background: rgba(147, 51, 234, 0.9);
            color: white;
        }

        .status-back-in-stock {
            background: rgba(34, 197, 94, 0.9);
            color: white;
        }

        .status-sold-out {
            background: rgba(220, 38, 38, 0.9);
            color: white;
        }

        .status-limited {
            background: rgba(245, 158, 11, 0.9);
            color: white;
        }

        .status-new {
            background: rgba(147, 51, 234, 0.9);
            color: white;
        }

        .status-extinct {
            background: rgba(220, 38, 38, 0.9);
            color: white;
        }

        .status-available {
            background: rgba(34, 197, 94, 0.9);
            color: white;
        }

        .status-in-stock {
            background: rgba(34, 197, 94, 0.9);
            color: white;
        }

        .plant-info {
            padding: 2rem;
        }

        .plant-id {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .plant-name {
            font-size: 1.4rem;
            font-weight: 600;
            color: #2c3e2d;
            margin-bottom: 0.5rem;
            font-style: italic;
        }

        .plant-location {
            font-size: 1rem;
            color: #7cb342;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .plant-description {
            color: #555;
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .plant-features {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .feature-tag {
            background: rgba(124, 179, 66, 0.1);
            color: #7cb342;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .plant-pricing {
            border-top: 1px solid #eee;
            padding-top: 1.5rem;
        }

        .price-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .price-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem;
            background: rgba(124, 179, 66, 0.05);
            border-radius: 8px;
        }

        .price-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex: 1;
            margin-right: 1rem;
        }

        .add-to-cart-btn {
            background: #7cb342;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s ease;
        }

        .add-to-cart-btn:hover {
            background: #689f38;
        }

        .add-to-cart-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        /* Cart Styles */
        .cart-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }

        .cart-item {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .cart-item-size {
            color: #666;
            margin-bottom: 0.5rem;
        }

        .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quantity-btn {
            background: #7cb342;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
        }

        .quantity-btn:hover {
            background: #689f38;
        }

        .quantity {
            font-weight: bold;
            min-width: 30px;
            text-align: center;
        }

        .cart-summary-section {
            background: rgba(124, 179, 66, 0.1);
            padding: 1.5rem;
            border-radius: 10px;
            margin: 2rem 0;
            border: 2px solid #7cb342;
        }

        .cart-total-line {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(124, 179, 66, 0.3);
        }

        .cart-total-line:last-child {
            border-bottom: none;
            font-weight: bold;
            font-size: 1.2rem;
            margin-top: 0.5rem;
            padding-top: 1rem;
            border-top: 2px solid #7cb342;
        }

        .bare-root-acknowledgment {
            background: rgba(255, 193, 7, 0.1);
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .acknowledgment-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .acknowledgment-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-top: 2px;
        }

        .acknowledgment-text {
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .tax-note {
            font-size: 0.85rem;
            color: #666;
            font-style: italic;
            margin-top: 0.5rem;
        }

        .checkout-btn {
            background: #2c3e2d;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 1rem;
            transition: all 0.3s ease;
        }

        .checkout-btn:hover:not(:disabled) {
            background: #1a2621;
        }

        .checkout-btn:disabled {
            background: #ccc;
            opacity: 0.5;
            cursor: not-allowed;
        }

        .continue-shopping {
            background: #666;
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 1rem;
        }

        .continue-shopping:hover {
            background: #555;
        }

        .payment-methods-info {
            background: rgba(124, 179, 66, 0.1);
            border: 1px solid rgba(124, 179, 66, 0.3);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .payment-methods-info h4 {
            color: #2c3e2d;
            margin-bottom: 0.8rem;
            font-size: 1.1rem;
        }

        .payment-methods-info p {
            margin: 0.5rem 0;
            color: #2c3e2d;
        }

        /* Order Form Styles */
        .order-form-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
        }

        .order-summary {
            background: rgba(124, 179, 66, 0.1);
            border: 1px solid rgba(124, 179, 66, 0.3);
            border-radius: 10px;
            padding: 2rem;
            height: fit-content;
            position: sticky;
            top: 2rem;
        }

        .order-summary h3 {
            color: #2c3e2d;
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
        }

        .order-form {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .order-form h3 {
            color: #2c3e2d;
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #2c3e2d;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #7cb342;
            box-shadow: 0 0 0 2px rgba(124, 179, 66, 0.2);
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .submit-order-btn {
            background: #2c3e2d;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            flex: 1;
            transition: all 0.3s ease;
        }

        .submit-order-btn:hover {
            background: #1a2621;
        }

        .back-to-cart-btn {
            background: #666;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            cursor: pointer;
            flex: 1;
        }

        .back-to-cart-btn:hover {
            background: #555;
        }

        .order-item-review {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(124, 179, 66, 0.3);
        }

        .order-totals-review {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            border: 1px solid rgba(124, 179, 66, 0.3);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .order-form-container {
                grid-template-columns: 1fr;
                gap: 2rem;
                padding: 1rem;
            }

            .order-summary {
                position: static;
            }

            .form-actions {
                flex-direction: column;
            }
        }
        
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .plant-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .category-grid {
                grid-template-columns: 1fr;
            }
            
            header {
                padding: 0.8rem 0;
            }
            
            .header-content {
                justify-content: center;
                gap: 0.5rem;
            }
            
            .logo {
                display: none !important;
            }
            
            .contact-info {
                display: none !important;
            }
            
            .header-right {
                justify-content: center;
            }
            
            nav ul {
                justify-content: center;
                flex-wrap: wrap;
                gap: 0.8rem;
            }
            
            nav a {
                padding: 0.3rem 0.8rem;
                font-size: 0.9rem;
            }

            .category-controls {
                flex-direction: column;
                padding: 1rem;
                gap: 1rem;
            }

            .search-box {
                width: 100%;
            }

            .sort-controls {
                flex-wrap: wrap;
                justify-content: center;
            }

            .sort-btn {
                font-size: 0.8rem;
                padding: 0.6rem 1rem;
            }

            .cart-item {
                flex-direction: column;
                align-items: stretch;
                text-align: center;
            }

            .cart-item-controls {
                margin-top: 1rem;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Indicator -->
    <div id="data-loader" class="loader-overlay">
        <div class="loader-content">
            <div class="spinner"></div>
            <p>Loading plant inventory...</p>
            <p style="font-size: 0.9rem; margin-top: 0.5rem; opacity: 0.8;">Please wait while we fetch the latest data</p>
        </div>
    </div>

    <!-- Navigation Overlay -->
    <div class="nav-overlay" id="nav-overlay" onclick="closeNavMenu()"></div>
    
    <!-- Navigation Menu -->
    <div class="nav-menu" id="nav-menu">
        <button class="nav-close" onclick="closeNavMenu()">×</button>
        <div class="nav-menu-header">
            <h3 class="nav-menu-title">Categories</h3>
        </div>
        <ul>
            <li><a onclick="navigateAndCloseMenu('home')" id="nav-home" class="active">Home</a></li>
            <li><a onclick="navigateAndCloseMenu('flavas')" id="nav-flavas">Flava</a></li>
            <li><a onclick="navigateAndCloseMenu('leucophyllas')" id="nav-leucophyllas">Leucophylla</a></li>
            <li><a onclick="navigateAndCloseMenu('purpureas')" id="nav-purpureas">Purpurea</a></li>
            <li><a onclick="navigateAndCloseMenu('minors')" id="nav-minors">Minor</a></li>
            <li><a onclick="navigateAndCloseMenu('hybrids')" id="nav-hybrids">Hybrid</a></li>
            <li><a onclick="navigateAndCloseMenu('alata')" id="nav-alata">Alata</a></li>
            <li><a onclick="navigateAndCloseMenu('psittacina')" id="nav-psittacina">Psittacina</a></li>
            <li><a onclick="navigateAndCloseMenu('oreophila')" id="nav-oreophila">Oreophila</a></li>
            <li><a onclick="navigateAndCloseMenu('rubra')" id="nav-rubra">Rubra</a></li>
            <li><a onclick="navigateAndCloseMenu('venus-flytraps')" id="nav-venus-flytraps">Venus Flytrap</a></li>
            <li><a onclick="navigateAndCloseMenu('utricularia')" id="nav-utricularia">Utricularia</a></li>
            <li><a onclick="navigateAndCloseMenu('cephalotus')" id="nav-cephalotus">Cephalotus</a></li>
            <li><a onclick="navigateAndCloseMenu('darlingtonia')" id="nav-darlingtonia">Darlingtonia</a></li>
            <li><a onclick="navigateAndCloseMenu('companion-plants')" id="nav-companion-plants">Companion Plant</a></li>
        </ul>
    </div>

    <!-- Image Modal -->
    <div class="image-modal" id="image-modal" onclick="closeImageModal(event)">
        <div class="image-modal-content">
            <button class="image-modal-close" onclick="closeImageModal()">&times;</button>
            <div class="image-modal-title" id="modal-title"></div>
            <img id="modal-image" src="" alt="">
        </div>
    </div>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="header-left">
                    <button class="hamburger-menu" onclick="openNavMenu()">☰</button>
                    <a class="logo" onclick="navigateTo('home')">Mike Wang's Sarracenia</a>
                </div>
                <div class="header-right">
                    <div class="cart-icon" onclick="showCart()">
                        🛒
                        <span id="cart-count">0</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- HOME PAGE -->
    <section id="home-page" class="page-section active">
        <div class="hero">
            <div class="container">
                <h1>The Largest Selection of Species Sarracenia in the US</h1>
                <p>Premium carnivorous plants from a dedicated hobbyist directly to collectors and enthusiasts</p>
                <p class="hero-subtitle">Visit our <a href="https://sarracenia.proboards.com/thread/454/mike-wangs-sarracenia-sale" target="_blank" style="color: #7cb342; text-decoration: none;">Sarracenia Forum discussion</a> for detailed photos and information</p>
                
                <div class="announcement">
                    🌱 WE SHIP ALL YEAR ROUND, ALWAYS OPEN FOR BUSINESS! 🌱<br>
                    Updated 2025 inventory available • Plants sent bare root • Shipping $11-$40
                </div>
            </div>
        </div>

        <main class="container">
            <section>
                <h2 class="section-title">Browse Our Collection</h2>
                
                <div class="category-grid" id="home-categories">
                    <!-- Categories will be populated by JavaScript -->
                </div>
            </section>

            <section class="about">
                <h2>About Mike Wang's Sarracenia</h2>
                <p>Welcome to the largest selection of species Sarracenia in the United States! I've been growing carnivorous plants as a passionate hobbyist for many years, specializing in rare, extinct-in-the-wild, and exceptional clones with documented location data.</p>
                
                <div class="highlight">
                    <img src="images/mike-with-plants.jpg" alt="" class="highlight-image">
                    <strong>What makes our plants special:</strong> Every plant is carefully grown and divided by me personally. These are not tiny tissue culture specimens, but rather lovingly cultivated plants given time to develop strong root systems and robust growth. Many of our clones are exclusive and not available anywhere else in the world.
                </div>
                
                <p>Our collection includes over 400 varieties of Sarracenia, ranging from common species to incredibly rare clones that exist only in cultivation after their wild populations were destroyed. We also carry premium Venus flytraps, Darlingtonia, bog orchids, and companion plants.</p>
                
                <p><strong>Plant Sizes:</strong> <strong>Small</strong> plants reach flowering size within 2 to 3 years. <strong>Medium</strong> plants reach flowering size in 1 to 2 years. <strong>Large</strong> plants are flowering size.</p>
                
                <p><strong>Ordering:</strong> Email orders to meizzwang@gmail.com before sending payment. If you're looking for anything not on our list, feel free to ask! Response time: typically within 24 hours Monday-Friday.</p>
            </section>
        </main>
    </section>

    <!-- CART PAGE -->
    <section id="cart-page" class="page-section">
        <main class="container">
            <h1>Shopping Cart</h1>
            <div class="cart-container">
                <div id="cart-items">
                    <!-- Cart items will be populated by JavaScript -->
                </div>
                <div id="cart-empty" style="text-align: center; padding: 2rem; display: none;">
                    <h3>Your cart is empty</h3>
                    <p>Browse our collection and add some amazing plants!</p>
                    <button class="continue-shopping" onclick="navigateTo('home')">Continue Shopping</button>
                </div>
                <div id="cart-summary" style="display: none;">
                    <div class="cart-summary-section">
                        <div class="cart-total-line">
                            <span>Subtotal:</span>
                            <span>$<span id="cart-subtotal">0</span></span>
                        </div>
                        <div class="cart-total-line">
                            <span id="tax-label">Sales Tax (est.):</span>
                            <span>$<span id="cart-tax">0</span></span>
                        </div>
                        <div class="cart-total-line">
                            <span>Shipping:</span>
                            <span>TBD ($11-$40)</span>
                        </div>
                        <div class="cart-total-line">
                            <span>Estimated Total (before shipping):</span>
                            <span>$<span id="cart-total-amount">0</span></span>
                        </div>
                        <div class="tax-note" id="tax-note">
                            * CA sales tax (10.25%) applies to California deliveries only. Out-of-state orders are tax-free.
                        </div>
                    </div>
                    
                    <div class="bare-root-acknowledgment">
                        <div class="acknowledgment-checkbox">
                            <input type="checkbox" id="bare-root-checkbox" required>
                            <label for="bare-root-checkbox" class="acknowledgment-text">
                                <strong>I understand that all plants are shipped bare root.</strong><br>
                                Plants will arrive without soil and may appear dormant or stressed. This is normal for bare root shipping and plants will recover with proper care.
                            </label>
                        </div>
                    </div>
                    
                    
                    <div class="payment-methods-info">
                        <h4>Payment Methods Accepted:</h4>
                        <p>Zelle, Venmo, Cashapp, PayPal, Cash, Check, Money Orders</p>
                        <p style="font-size: 0.9rem; font-style: italic;">If you need different payment instructions, please let me know - if I can accommodate, I will do what I can to work with you!</p>
                    </div>
                    
                    <button class="checkout-btn" id="checkout-button" onclick="showOrderForm()" disabled>Submit Order Request</button>
                    <button class="continue-shopping" onclick="navigateTo('home')">Continue Shopping</button>
                </div>
            </div>
        </main>
    </section>

    <!-- ORDER FORM PAGE -->
    <section id="order-form-page" class="page-section">
        <main class="container">
            <h1>Submit Order Request</h1>
            <div class="order-form-container">
                <div class="order-summary">
                    <h3>Order Summary</h3>
                    <div id="order-items-review"></div>
                    <div id="order-totals-review"></div>
                </div>
                
                <form id="order-form" class="order-form">
                    <h3>Your Information</h3>
                    
                    <div class="form-group">
                        <label for="customer-name">Full Name *</label>
                        <input type="text" id="customer-name" name="name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="customer-email">Email Address *</label>
                        <input type="email" id="customer-email" name="email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="customer-phone">Phone Number</label>
                        <input type="tel" id="customer-phone" name="phone">
                    </div>
                    
                    <div class="form-group">
                        <label for="shipping-address">Shipping Address</label>
                        <textarea id="shipping-address" name="address" rows="4" placeholder="Street Address
City, State ZIP
Country"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="preferred-payment">Preferred Payment Method</label>
                        <select id="preferred-payment" name="payment">
                            <option value="">Select payment method</option>
                            <option value="zelle">Zelle</option>
                            <option value="venmo">Venmo</option>
                            <option value="cashapp">CashApp</option>
                            <option value="paypal">PayPal</option>
                            <option value="check">Check</option>
                            <option value="money-order">Money Order</option>
                            <option value="cash">Cash (pickup only)</option>
                            <option value="other">Other (please specify in notes)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="order-notes">Additional Notes</label>
                        <textarea id="order-notes" name="notes" rows="3" placeholder="Special requests, questions, or other payment method details..."></textarea>
                    </div>
                    
                    <p style="text-align: center; color: #666; margin: 1rem 0; font-style: italic;">
                        Feel free to skip your address and phone number if you are just requesting a precise quote including shipping and taxes.
                    </p>
                    
                    <div class="form-actions">
                        <button type="submit" class="submit-order-btn">Send Order Request</button>
                        <button type="button" class="back-to-cart-btn" onclick="showCart()">Back to Cart</button>
                    </div>
                </form>
            </div>
        </main>
    </section>

    <!-- Dynamic Category Pages (will be populated by JavaScript) -->
    <section id="flavas-page" class="page-section">
        <main class="container">
            <h1>Sarracenia Flava Collection</h1>
            <div class="category-controls">
                <input type="text" class="search-box" id="flavas-search" placeholder="🔍 Search Flava varieties..." oninput="searchCategory('flavas')">
                <div class="sort-controls">
                    <span>Sort by:</span>
                    <button class="sort-btn active" onclick="sortCategory('flavas', 'clone')">Clone #</button>
                    <button class="sort-btn" onclick="sortCategory('flavas', 'price-low')">Price ↑</button>
                    <button class="sort-btn" onclick="sortCategory('flavas', 'price-high')">Price ↓</button>
                </div>
                <label class="stock-toggle">
                    <input type="checkbox" id="flavas-include-out-of-stock" onchange="toggleOutOfStock('flavas')">
                    Include out of stock items
                </label>
                <div class="results-count" id="flavas-count"></div>
            </div>
            <div class="plant-grid" id="flavas-grid"></div>
        </main>
    </section>

    <section id="leucophyllas-page" class="page-section">
        <main class="container">
            <h1>Sarracenia Leucophylla Collection</h1>
            <div class="category-controls">
                <input type="text" class="search-box" id="leucophyllas-search" placeholder="🔍 Search Leucophylla varieties..." oninput="searchCategory('leucophyllas')">
                <div class="sort-controls">
                    <span>Sort by:</span>
                    <button class="sort-btn active" onclick="sortCategory('leucophyllas', 'clone')">Clone #</button>
                    <button class="sort-btn" onclick="sortCategory('leucophyllas', 'price-low')">Price ↑</button>
                    <button class="sort-btn" onclick="sortCategory('leucophyllas', 'price-high')">Price ↓</button>
                </div>
                <label class="stock-toggle">
                    <input type="checkbox" id="leucophyllas-include-out-of-stock" onchange="toggleOutOfStock('leucophyllas')">
                    Include out of stock items
                </label>
                <div class="results-count" id="leucophyllas-count"></div>
            </div>
            <div class="plant-grid" id="leucophyllas-grid"></div>
        </main>
    </section>

    <section id="purpureas-page" class="page-section">
        <main class="container">
            <h1>Sarracenia Purpurea Collection</h1>
            <div class="category-controls">
                <input type="text" class="search-box" id="purpureas-search" placeholder="🔍 Search Purpurea varieties..." oninput="searchCategory('purpureas')">
                <div class="sort-controls">
                    <span>Sort by:</span>
                    <button class="sort-btn active" onclick="sortCategory('purpureas', 'clone')">Clone #</button>
                    <button class="sort-btn" onclick="sortCategory('purpureas', 'price-low')">Price ↑</button>
                    <button class="sort-btn" onclick="sortCategory('purpureas', 'price-high')">Price ↓</button>
                </div>
                <label class="stock-toggle">
                    <input type="checkbox" id="purpureas-include-out-of-stock" onchange="toggleOutOfStock('purpureas')">
                    Include out of stock items
                </label>
                <div class="results-count" id="purpureas-count"></div>
            </div>
            <div class="plant-grid" id="purpureas-grid"></div>
        </main>
    </section>

    <section id="minors-page" class="page-section">
        <main class="container">
            <h1>Sarracenia Minor Collection</h1>
            <div class="category-controls">
                <input type="text" class="search-box" id="minors-search" placeholder="🔍 Search Minor varieties..." oninput="searchCategory('minors')">
                <div class="sort-controls">
                    <span>Sort by:</span>
                    <button class="sort-btn active" onclick="sortCategory('minors', 'clone')">Clone #</button>
                    <button class="sort-btn" onclick="sortCategory('minors', 'price-low')">Price ↑</button>
                    <button class="sort-btn" onclick="sortCategory('minors', 'price-high')">Price ↓</button>
                </div>
                <label class="stock-toggle">
                    <input type="checkbox" id="minors-include-out-of-stock" onchange="toggleOutOfStock('minors')">
                    Include out of stock items
                </label>
                <div class="results-count" id="minors-count"></div>
            </div>
            <div class="plant-grid" id="minors-grid"></div>
        </main>
    </section>

    <section id="hybrids-page" class="page-section">
        <main class="container">
            <h1>Sarracenia Hybrids Collection</h1>
            <div class="category-controls">
                <input type="text" class="search-box" id="hybrids-search" placeholder="🔍 Search Hybrid varieties..." oninput="searchCategory('hybrids')">
                <div class="sort-controls">
                    <span>Sort by:</span>
                    <button class="sort-btn active" onclick="sortCategory('hybrids', 'clone')">Clone #</button>
                    <button class="sort-btn" onclick="sortCategory('hybrids', 'price-low')">Price ↑</button>
                    <button class="sort-btn" onclick="sortCategory('hybrids', 'price-high')">Price ↓</button>
                </div>
                <label class="stock-toggle">
                    <input type="checkbox" id="hybrids-include-out-of-stock" onchange="toggleOutOfStock('hybrids')">
                    Include out of stock items
                </label>
                <div class="results-count" id="hybrids-count"></div>
            </div>
            <div class="plant-grid" id="hybrids-grid"></div>
        </main>
    </section>

    <section id="alata-page" class="page-section">
        <main class="container">
            <h1>Sarracenia Alata Collection</h1>
            <div class="category-controls">
                <input type="text" class="search-box" id="alata-search" placeholder="🔍 Search Alata varieties..." oninput="searchCategory('alata')">
                <div class="sort-controls">
                    <span>Sort by:</span>
                    <button class="sort-btn active" onclick="sortCategory('alata', 'clone')">Clone #</button>
                    <button class="sort-btn" onclick="sortCategory('alata', 'price-low')">Price ↑</button>
                    <button class="sort-btn" onclick="sortCategory('alata', 'price-high')">Price ↓</button>
                </div>
                <label class="stock-toggle">
                    <input type="checkbox" id="alata-include-out-of-stock" onchange="toggleOutOfStock('alata')">
                    Include out of stock items
                </label>
                <div class="results-count" id="alata-count"></div>
            </div>
            <div class="plant-grid" id="alata-grid"></div>
        </main>
    </section>

    <section id="psittacina-page" class="page-section">
        <main class="container">
            <h1>Sarracenia Psittacina Collection</h1>
            <div class="category-controls">
                <input type="text" class="search-box" id="psittacina-search" placeholder="🔍 Search Psittacina varieties..." oninput="searchCategory('psittacina')">
                <div class="sort-controls">
                    <span>Sort by:</span>
                    <button class="sort-btn active" onclick="sortCategory('psittacina', 'clone')">Clone #</button>
                    <button class="sort-btn" onclick="sortCategory('psittacina', 'price-low')">Price ↑</button>
                    <button class="sort-btn" onclick="sortCategory('psittacina', 'price-high')">Price ↓</button>
                </div>
                <label class="stock-toggle">
                    <input type="checkbox" id="psittacina-include-out-of-stock" onchange="toggleOutOfStock('psittacina')">
                    Include out of stock items
                </label>
                <div class="results-count" id="psittacina-count"></div>
            </div>
            <div class="plant-grid" id="psittacina-grid"></div>
        </main>
    </section>

    <section id="oreophila-page" class="page-section">
        <main class="container">
            <h1>Sarracenia Oreophila Collection</h1>
            
            <div style="background: #ffeb3b; border: 3px solid #f57f17; border-radius: 10px; padding: 20px; margin: 20px 0; text-align: center;">
                <h2 style="color: #e65100; font-size: 1.8rem; font-weight: bold; margin: 0;">
                    ⚠️ CALIFORNIA SHIPPING ONLY ⚠️
                </h2>
                <p style="color: #d84315; font-size: 1.2rem; font-weight: bold; margin: 10px 0 0 0;">
                    S. oreophila is CITES Appendix I listed and U.S. Endangered Species Act protected - interstate shipping prohibited by federal law
                </p>
            </div>
            
            <div class="category-controls">
                <input type="text" class="search-box" id="oreophila-search" placeholder="🔍 Search Oreophila varieties..." oninput="searchCategory('oreophila')">
                <div class="sort-controls">
                    <span>Sort by:</span>
                    <button class="sort-btn active" onclick="sortCategory('oreophila', 'clone')">Clone #</button>
                    <button class="sort-btn" onclick="sortCategory('oreophila', 'price-low')">Price ↑</button>
                    <button class="sort-btn" onclick="sortCategory('oreophila', 'price-high')">Price ↓</button>
                </div>
                <label class="stock-toggle">
                    <input type="checkbox" id="oreophila-include-out-of-stock" onchange="toggleOutOfStock('oreophila')">
                    Include out of stock items
                </label>
                <div class="results-count" id="oreophila-count"></div>
            </div>
            <div class="plant-grid" id="oreophila-grid"></div>
        </main>
    </section>

    <section id="rubra-page" class="page-section">
        <main class="container">
            <h1>Sarracenia Rubra Collection</h1>
            <div class="category-controls">
                <input type="text" class="search-box" id="rubra-search" placeholder="🔍 Search Rubra varieties..." oninput="searchCategory('rubra')">
                <div class="sort-controls">
                    <span>Sort by:</span>
                    <button class="sort-btn active" onclick="sortCategory('rubra', 'clone')">Clone #</button>
                    <button class="sort-btn" onclick="sortCategory('rubra', 'price-low')">Price ↑</button>
                    <button class="sort-btn" onclick="sortCategory('rubra', 'price-high')">Price ↓</button>
                </div>
                <label class="stock-toggle">
                    <input type="checkbox" id="rubra-include-out-of-stock" onchange="toggleOutOfStock('rubra')">
                    Include out of stock items
                </label>
                <div class="results-count" id="rubra-count"></div>
            </div>
            <div class="plant-grid" id="rubra-grid"></div>
        </main>
    </section>

    <section id="venus-flytraps-page" class="page-section">
        <main class="container">
            <h1>Venus Flytraps Collection</h1>
            <div class="category-controls">
                <input type="text" class="search-box" id="venus-flytraps-search" placeholder="🔍 Search Venus Flytrap varieties..." oninput="searchCategory('venus-flytraps')">
                <div class="sort-controls">
                    <span>Sort by:</span>
                    <button class="sort-btn active" onclick="sortCategory('venus-flytraps', 'clone')">Clone #</button>
                    <button class="sort-btn" onclick="sortCategory('venus-flytraps', 'price-low')">Price ↑</button>
                    <button class="sort-btn" onclick="sortCategory('venus-flytraps', 'price-high')">Price ↓</button>
                </div>
                <label class="stock-toggle">
                    <input type="checkbox" id="venus-flytraps-include-out-of-stock" onchange="toggleOutOfStock('venus-flytraps')">
                    Include out of stock items
                </label>
                <div class="results-count" id="venus-flytraps-count"></div>
            </div>
            <div class="plant-grid" id="venus-flytraps-grid"></div>
        </main>
    </section>

    <section id="darlingtonia-page" class="page-section">
        <main class="container">
            <h1>Darlingtonia Collection</h1>
            <div class="category-controls">
                <input type="text" class="search-box" id="darlingtonia-search" placeholder="🔍 Search Darlingtonia varieties..." oninput="searchCategory('darlingtonia')">
                <div class="sort-controls">
                    <span>Sort by:</span>
                    <button class="sort-btn active" onclick="sortCategory('darlingtonia', 'clone')">Clone #</button>
                    <button class="sort-btn" onclick="sortCategory('darlingtonia', 'price-low')">Price ↑</button>
                    <button class="sort-btn" onclick="sortCategory('darlingtonia', 'price-high')">Price ↓</button>
                </div>
                <label class="stock-toggle">
                    <input type="checkbox" id="darlingtonia-include-out-of-stock" onchange="toggleOutOfStock('darlingtonia')">
                    Include out of stock items
                </label>
                <div class="results-count" id="darlingtonia-count"></div>
            </div>
            <div class="plant-grid" id="darlingtonia-grid"></div>
        </main>
    </section>

    <section id="companion-plants-page" class="page-section">
        <main class="container">
            <h1>Companion Plants Collection</h1>
            <div class="category-controls">
                <input type="text" class="search-box" id="companion-plants-search" placeholder="🔍 Search Companion plants..." oninput="searchCategory('companion-plants')">
                <div class="sort-controls">
                    <span>Sort by:</span>
                    <button class="sort-btn active" onclick="sortCategory('companion-plants', 'clone')">Clone #</button>
                    <button class="sort-btn" onclick="sortCategory('companion-plants', 'price-low')">Price ↑</button>
                    <button class="sort-btn" onclick="sortCategory('companion-plants', 'price-high')">Price ↓</button>
                </div>
                <label class="stock-toggle">
                    <input type="checkbox" id="companion-plants-include-out-of-stock" onchange="toggleOutOfStock('companion-plants')">
                    Include out of stock items
                </label>
                <div class="results-count" id="companion-plants-count"></div>
            </div>
            <div class="plant-grid" id="companion-plants-grid"></div>
        </main>
    </section>

    <section id="utricularia-page" class="page-section">
        <main class="container">
            <h1>Utricularia Collection</h1>
            <div class="category-controls">
                <input type="text" class="search-box" id="utricularia-search" placeholder="🔍 Search Utricularia varieties..." oninput="searchCategory('utricularia')">
                <div class="sort-controls">
                    <button onclick="sortCategory('utricularia', 'price-low')" class="sort-btn">Price: Low to High</button>
                    <button onclick="sortCategory('utricularia', 'price-high')" class="sort-btn">Price: High to Low</button>
                    <button onclick="sortCategory('utricularia', 'alphabetical')" class="sort-btn">A-Z</button>
                </div>
                <label class="stock-toggle">
                    <input type="checkbox" id="utricularia-include-out-of-stock" onchange="toggleOutOfStock('utricularia')">
                    Include out of stock items
                </label>
                <div class="results-count" id="utricularia-count"></div>
            </div>
            <div class="plant-grid" id="utricularia-grid"></div>
        </main>
    </section>

    <section id="cephalotus-page" class="page-section">
        <main class="container">
            <h1>Cephalotus Collection</h1>
            <div class="category-controls">
                <input type="text" class="search-box" id="cephalotus-search" placeholder="🔍 Search Cephalotus varieties..." oninput="searchCategory('cephalotus')">
                <div class="sort-controls">
                    <button onclick="sortCategory('cephalotus', 'price-low')" class="sort-btn">Price: Low to High</button>
                    <button onclick="sortCategory('cephalotus', 'price-high')" class="sort-btn">Price: High to Low</button>
                    <button onclick="sortCategory('cephalotus', 'alphabetical')" class="sort-btn">A-Z</button>
                </div>
                <label class="stock-toggle">
                    <input type="checkbox" id="cephalotus-include-out-of-stock" onchange="toggleOutOfStock('cephalotus')">
                    Include out of stock items
                </label>
                <div class="results-count" id="cephalotus-count"></div>
            </div>
            <div class="plant-grid" id="cephalotus-grid"></div>
        </main>
    </section>

    <script>
        // Google Sheets Integration
        const SHEET_CONFIG = {
            SHEET_ID: '1AYHCuD1PoRHl7zDlQ32ishH_usO3-nTydlUnFP4urI8',
            API_KEY: 'AIzaSyDx_BUUT80GhgoK7PgjyEjX_eRORvFIWbY',
            SHEET_NAME: 'Sheet1',
            RANGE: 'A:P'
        };

        // Google Forms Configuration
        const GOOGLE_FORMS_CONFIG = {
            FORM_URL: 'https://docs.google.com/forms/d/1D65DYB9o-LFosm0i9oh8xU_z76po65CHeu-8kVx65yU/formResponse',
            // Updated field entry IDs after changing field types to paragraph
            FIELDS: {
                customer_name: 'entry.961803740',
                customer_email: 'entry.1598399655',
                customer_phone: 'entry.1274433847',
                shipping_address: 'entry.697537469',
                preferred_payment: 'entry.329257219',
                order_items: 'entry.1178592632',
                subtotal: 'entry.1688673874',
                tax_amount: 'entry.2124900688',
                estimated_total: 'entry.404301782',
                additional_notes: 'entry.247536416'
            }
        };

        // Global variables
        let plantData = {};
        let isDataLoaded = false;
        let currentPage = 'home';
        let currentCategory = null;
        
        // Clean up existing cart data that might have HTML entities
        function cleanCartData(cartData) {
            return cartData.map(item => ({
                ...item,
                name: decodeHtmlEntities(item.name || ''),
                size: decodeHtmlEntities(item.size || '')
            }));
        }
        
        let cart = cleanCartData(JSON.parse(localStorage.getItem('mikeWangCart')) || []);
        
        // Save cleaned cart back to localStorage
        if (cart.length > 0) {
            localStorage.setItem('mikeWangCart', JSON.stringify(cart));
        }

        // Google Analytics Integration
        // To activate, Mike needs to:
        // 1. Go to https://analytics.google.com
        // 2. Create account for mikesgarden.com (or whatever domain)
        // 3. Get tracking ID (looks like G-XXXXXXXXXX)
        // 4. Replace 'G-XXXXXXXXXX' below with real tracking ID
        
        // Google Analytics Global Site Tag (gtag.js)
        // Uncomment and replace G-XXXXXXXXXX with real tracking ID when ready:
        /*
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XXXXXXXXXX'); // Replace with real tracking ID
        */

        // Cache configuration
        const CACHE_DURATION = 5 * 60 * 1000; // 5 minutes
        let dataCache = { data: null, timestamp: null };

        // Category backgrounds
        const categoryBackgrounds = {
            'flavas': 'https://live.staticflickr.com/65535/53877361590_f86e4f5a28_b.jpg',
            'leucophyllas': 'https://live.staticflickr.com/65535/52482984499_815a1d2fd4_b.jpg',
            'purpureas': 'https://live.staticflickr.com/65535/52415496467_d7a4f28616_b.jpg',
            'minors': 'https://live.staticflickr.com/65535/53332900824_ffa3472192_b.jpg',
            'hybrids': 'https://live.staticflickr.com/4162/34376210482_93ec5b5236_b.jpg',
            'alata': 'https://live.staticflickr.com/65535/54205235709_b1796e252c_b.jpg',
            'psittacina': 'https://live.staticflickr.com/65535/52423000757_0dcc0f613d_b.jpg',
            'oreophila': 'https://live.staticflickr.com/65535/53547791005_131b99f4f2_b.jpg',
            'rubra': 'https://live.staticflickr.com/65535/54119549198_9951e92fb1_b.jpg',
            'venus-flytraps': 'https://live.staticflickr.com/65535/51385432443_39d115679b_b.jpg',
            'utricularia': 'https://live.staticflickr.com/65535/54536850570_3d978c75d9_b.jpg',
            'cephalotus': 'https://live.staticflickr.com/65535/54119211041_5172c92d0d_b.jpg',
            'darlingtonia': 'https://live.staticflickr.com/65535/53941696524_7540813c5d_b.jpg',
            'companion-plants': 'https://live.staticflickr.com/65535/54428648700_d655f7e6b5_b.jpg'
        };

        // Category titles (singular)
        const categoryTitles = {
            'flavas': 'Flava',
            'leucophyllas': 'Leucophylla',
            'purpureas': 'Purpurea',
            'minors': 'Minor',
            'hybrids': 'Hybrid',
            'alata': 'Alata',
            'psittacina': 'Psittacina',
            'oreophila': 'Oreophila',
            'rubra': 'Rubra',
            'venus-flytraps': 'Venus Flytrap',
            'utricularia': 'Utricularia',
            'cephalotus': 'Cephalotus',
            'darlingtonia': 'Darlingtonia',
            'companion-plants': 'Companion Plant'
        };

        // Category descriptions
        const categoryDescriptions = {
            'flavas': 'Yellow pitcher plants with incredible variety - from common forms to extremely rare clones',
            'leucophyllas': 'White-topped pitcher plants including extinct Hurricane Creek White varieties',
            'purpureas': 'Purple pitcher plants including rare venosa and montana varieties',
            'minors': 'Hooded pitcher plants including giant okefenokeensis varieties extinct in the wild',
            'hybrids': 'Registered cultivars and rare crosses including exclusives',
            'alata': 'Southern pitcher plants with distinctive wide-mouthed pitchers and prominent wings',
            'psittacina': 'Parrot pitcher plants with unique lobster-trap style pitchers and colorful venation',
            'oreophila': 'Mountain pitcher plants - critically endangered species with distinctive yellow-green pitchers',
            'rubra': 'Sweet pitcher plants with slender, elegant pitchers in various colorations',
            'venus-flytraps': 'Dionaea muscipula cultivars and location-documented wild genetics',
            'utricularia': 'Bladderworts - aquatic and terrestrial carnivorous plants with tiny bladder traps',
            'cephalotus': 'Australian pitcher plants - unique carnivorous plants with distinctive pitchers',
            'darlingtonia': 'Cobra plants from California and Oregon populations',
            'companion-plants': 'Bog orchids, lilies, and other carnivorous plant companions'
        };

        // Fetch plant data from Google Sheets
        async function fetchPlantData() {
            if (dataCache.data && dataCache.timestamp && 
                (Date.now() - dataCache.timestamp) < CACHE_DURATION) {
                return dataCache.data;
            }

            const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_CONFIG.SHEET_ID}/values/${SHEET_CONFIG.SHEET_NAME}!${SHEET_CONFIG.RANGE}?key=${SHEET_CONFIG.API_KEY}`;
            
            try {
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                dataCache.data = data;
                dataCache.timestamp = Date.now();
                return data;
            } catch (error) {
                console.error('Error fetching data from Google Sheets:', error);
                throw error;
            }
        }

        // Convert Google Sheets data to plant data format
        function convertSheetsDataToPlantData(sheetsData) {
            if (!sheetsData.values || sheetsData.values.length < 2) {
                return {};
            }
            
            const [headers, ...rows] = sheetsData.values;
            
            const categories = {};
            
            rows.forEach((row, index) => {
                try {
                    if (!row[0] || !row[1]) return; // Skip empty rows
                    
                    const plant = convertRowToPlant(headers, row);
                    if (plant) {
                        if (!categories[plant.category]) {
                            categories[plant.category] = [];
                        }
                        
                        const { category, ...plantWithoutCategory } = plant;
                        categories[category].push(plantWithoutCategory);
                    }
                } catch (error) {
                    console.error(`Error processing row ${index + 2}:`, error, row);
                }
            });
            
            return categories;
        }

        // Convert a single row to plant object
        function convertRowToPlant(headers, row) {
            const getColumn = (name) => headers.indexOf(name);
            
            const category = row[getColumn('category')]?.trim();
            const id = row[getColumn('id')]?.trim();
            
            if (!category || !id) return null;
            
            // Build prices array
            const prices = [];
            for (let i = 1; i <= 3; i++) {
                const sizeName = row[getColumn(`size${i}_name`)]?.trim();
                const sizePrice = parseFloat(row[getColumn(`size${i}_price`)]);
                
                if (sizeName && !isNaN(sizePrice)) {
                    prices.push({ size: sizeName, price: sizePrice });
                }
            }
            
            // Convert features string to array
            const featuresString = row[getColumn('features')]?.trim();
            const features = featuresString ? featuresString.split('|').map(f => f.trim()) : [];
            
            // Handle image URL
            const imageUrl = row[getColumn('image_url')]?.trim();
            const image = (imageUrl && imageUrl !== 'null' && imageUrl !== '') ? imageUrl : null;
            
            return {
                category: category,
                id: id,
                name: row[getColumn('name')]?.trim() || '',
                location: row[getColumn('location')]?.trim() || '',
                variety: row[getColumn('variety')]?.trim() || '',
                description: row[getColumn('description')]?.trim() || '',
                features: features,
                prices: prices,
                image: image,
                status: row[getColumn('status')]?.trim() || 'available',
                availability: row[getColumn('availability')]?.trim() || 'available'
            };
        }

        // Initialize plant data
        async function initializePlantData() {
            try {
                showLoadingIndicator();
                
                const sheetsData = await fetchPlantData();
                plantData = convertSheetsDataToPlantData(sheetsData);
                isDataLoaded = true;
                
                hideLoadingIndicator();
                updateCartIcon();
                loadHomePage();
                
                // If we're on a category page, reload the data
                if (currentPage && currentPage !== 'home') {
                    loadCategoryData(currentPage);
                }
                
            } catch (error) {
                console.error('Failed to load plant data:', error);
                hideLoadingIndicator();
                alert('Failed to load plant data from Google Sheets. Please refresh the page to try again.');
            }
        }

        // Load home page with category cards
        function loadHomePage() {
            const categoriesContainer = document.getElementById('home-categories');
            if (!categoriesContainer || !isDataLoaded) return;

            // Show all configured categories, even if they don't have data yet
            const allCategories = Object.keys(categoryBackgrounds);
            
            const categoryCards = allCategories.map(category => {
                const count = plantData[category] ? plantData[category].length : 0;
                const background = categoryBackgrounds[category] || '';
                const description = categoryDescriptions[category] || '';
                const title = categoryTitles[category] || category.split('-').map(word => 
                    word.charAt(0).toUpperCase() + word.slice(1)
                ).join(' ');

                const countText = count > 0 ? `${count} varieties available` : 'Coming soon';

                return `
                    <div class="category-card" onclick="navigateTo('${category}')" style="background-image: url('${background}')">
                        <h3 class="category-title">${title}</h3>
                        <p class="category-description">${description}</p>
                        <div class="category-count">${countText}</div>
                    </div>
                `;
            }).join('');

            categoriesContainer.innerHTML = categoryCards;
        }

        // Show/hide loading indicator
        function showLoadingIndicator() {
            document.getElementById('data-loader').style.display = 'flex';
        }

        function hideLoadingIndicator() {
            document.getElementById('data-loader').style.display = 'none';
        }

        // Hamburger Menu Functions
        function openNavMenu() {
            document.getElementById('nav-menu').classList.add('open');
            document.getElementById('nav-overlay').classList.add('show');
            document.body.style.overflow = 'hidden'; // Prevent scrolling when menu is open
        }

        function closeNavMenu() {
            document.getElementById('nav-menu').classList.remove('open');
            document.getElementById('nav-overlay').classList.remove('show');
            document.body.style.overflow = ''; // Restore scrolling
        }

        // Close menu when navigation link is clicked
        function navigateAndCloseMenu(page) {
            closeNavMenu();
            navigateTo(page);
        }

        // Image Modal Functions
        function openImageModal(imageSrc, plantName) {
            console.log('Opening image modal:', imageSrc, plantName); // Debug log
            const modal = document.getElementById('image-modal');
            const modalImage = document.getElementById('modal-image');
            const modalTitle = document.getElementById('modal-title');
            
            if (!modal || !modalImage || !modalTitle) {
                console.error('Modal elements not found');
                return;
            }
            
            modalImage.src = imageSrc;
            modalImage.alt = plantName;
            modalTitle.textContent = plantName;
            modal.classList.add('show');
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
        }

        function closeImageModal(event) {
            // Only close if clicking the modal background or close button (not the content)
            if (event && event.target !== event.currentTarget && !event.target.classList.contains('image-modal-close')) {
                return;
            }
            
            const modal = document.getElementById('image-modal');
            modal.classList.remove('show');
            document.body.style.overflow = ''; // Restore scrolling
        }

        // Close modal with ESC key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeImageModal();
            }
        });

        // Navigation
        function navigateTo(page) {
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.remove('active');
            });

            // Remove active states from both old nav and hamburger menu
            document.querySelectorAll('nav a, .nav-menu a').forEach(link => {
                link.classList.remove('active');
            });

            const targetPage = document.getElementById(page + '-page');
            if (targetPage) {
                targetPage.classList.add('active');
                // Only add active state to "Home" in the hamburger menu, not other categories
                if (page === 'home') {
                    document.getElementById('nav-' + page)?.classList.add('active');
                }
            }

            window.location.hash = page;
            currentPage = page;

            if (page === 'home') {
                loadHomePage();
            } else if (page !== 'cart') {
                loadCategoryData(page);
            }

            window.scrollTo(0, 0);
        }

        // Load category data
        // Search and Sort Functions
        let originalCategoryData = {}; // Store original data for filtering
        let currentSort = {}; // Track current sort for each category
        let includeOutOfStock = {}; // Track out-of-stock inclusion for each category

        function toggleOutOfStock(category) {
            const checkbox = document.getElementById(`${category}-include-out-of-stock`);
            includeOutOfStock[category] = checkbox ? checkbox.checked : false;
            
            console.log(`Toggling out of stock for ${category}: ${includeOutOfStock[category]}`);
            
            // Re-run search to apply the filter
            searchCategory(category);
        }

        function searchCategory(category) {
            const searchTerm = document.getElementById(`${category}-search`).value.toLowerCase();
            const originalData = originalCategoryData[category] || plantData[category] || [];
            
            let filteredData = originalData.filter(plant => {
                // Search filter
                const matchesSearch = plant.name.toLowerCase().includes(searchTerm) ||
                    plant.description.toLowerCase().includes(searchTerm) ||
                    plant.location.toLowerCase().includes(searchTerm);
                
                // Stock filter - if checkbox is unchecked, exclude out-of-stock items
                // Default to "in stock" for any status, only exclude explicitly out-of-stock statuses
                const outOfStockStatuses = ['sold-out', 'sold out', 'unavailable', 'not available'];
                const isOutOfStock = outOfStockStatuses.includes((plant.status || '').toLowerCase()) || 
                                   outOfStockStatuses.includes((plant.availability || '').toLowerCase());
                const includeThis = includeOutOfStock[category] || !isOutOfStock;
                
                return matchesSearch && includeThis;
            });

            // Apply current sort if any
            if (currentSort[category]) {
                filteredData = applySortToData(filteredData, currentSort[category]);
            }

            // Update results count
            document.getElementById(`${category}-count`).textContent = 
                `${filteredData.length} of ${originalData.length} plants`;

            // Render filtered results
            renderPlantGrid(category, filteredData);
        }

        function sortCategory(category, sortType) {
            // Update active button
            const buttons = document.querySelectorAll(`#${category}-page .sort-btn`);
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Store current sort
            currentSort[category] = sortType;

            // Get current data (filtered or original)
            const searchTerm = document.getElementById(`${category}-search`).value.toLowerCase();
            const originalData = originalCategoryData[category] || plantData[category] || [];
            
            let dataToSort = searchTerm ? 
                originalData.filter(plant => 
                    plant.name.toLowerCase().includes(searchTerm) ||
                    plant.description.toLowerCase().includes(searchTerm) ||
                    plant.location.toLowerCase().includes(searchTerm)
                ) : originalData;

            // Apply sort
            const sortedData = applySortToData(dataToSort, sortType);

            // Render sorted results
            renderPlantGrid(category, sortedData);
        }

        function applySortToData(data, sortType) {
            const sortedData = [...data];
            
            switch(sortType) {
                case 'clone':
                    return sortedData.sort((a, b) => getCloneNumber(a) - getCloneNumber(b));
                case 'price-low':
                    return sortedData.sort((a, b) => getLowestPrice(a) - getLowestPrice(b));
                case 'price-high':
                    return sortedData.sort((a, b) => getLowestPrice(b) - getLowestPrice(a));
                default:
                    return sortedData;
            }
        }

        function getCloneNumber(plant) {
            // Extract clone number from plant ID (F1, F2, L15, D1, D34, etc.)
            const match = plant.id.match(/([A-Z]+)(\d+)/);
            if (match) {
                const letter = match[1];
                const number = parseInt(match[2]); // parseInt handles F01, F1, F100 correctly
                // Sort by letter first, then number numerically (D1, D2, D34, F1, F2, F10, F100, L1, L2, etc.)
                return (letter.charCodeAt(0) - 65) * 100000 + number; // Increased multiplier for larger numbers
            }
            // If no clone pattern found, sort alphabetically as fallback
            return plant.id.charCodeAt(0) * 100000;
        }

        function getLowestPrice(plant) {
            if (!plant.prices || plant.prices.length === 0) return 0;
            return Math.min(...plant.prices.map(p => p.price));
        }

        function renderPlantGrid(category, plants) {
            const grid = document.getElementById(`${category}-grid`);
            if (!grid) return;

            if (plants.length === 0) {
                grid.innerHTML = '<div style="text-align: center; padding: 2rem; color: #666;">No plants found matching your search.</div>';
                return;
            }

            grid.innerHTML = plants.map(plant => createPlantCard(plant)).join('');
            
            // Add click event listeners for image modal (Safari-compatible)
            grid.querySelectorAll('.clickable-image').forEach((img, index) => {
                console.log('Adding click listener to image', index, img.src, img.dataset);
                
                // Try multiple event binding approaches for Safari compatibility
                img.style.cursor = 'pointer';
                img.addEventListener('click', function(e) {
                    console.log('Image clicked!', this.dataset.imageSrc, this.dataset.plantName);
                    e.preventDefault();
                    e.stopPropagation();
                    const imageSrc = this.dataset.imageSrc;
                    const plantName = this.dataset.plantName;
                    if (imageSrc && plantName) {
                        openImageModal(imageSrc, plantName);
                    } else {
                        console.error('Missing image data:', {imageSrc, plantName});
                    }
                });
                
                // Alternative approach using mousedown for Safari
                img.addEventListener('mousedown', function(e) {
                    console.log('Image mousedown!', this.dataset.imageSrc);
                });
                
                // Touch events for mobile Safari
                img.addEventListener('touchstart', function(e) {
                    console.log('Image touch!', this.dataset.imageSrc);
                    e.preventDefault();
                    const imageSrc = this.dataset.imageSrc;
                    const plantName = this.dataset.plantName;
                    if (imageSrc && plantName) {
                        openImageModal(imageSrc, plantName);
                    }
                });
            });
            
            // Add event listeners for add to cart buttons
            grid.querySelectorAll('.add-to-cart-btn').forEach(button => {
                button.addEventListener('click', function() {
                    try {
                        if (this.disabled) return;
                        
                        const plantId = this.dataset.plantId;
                        const plantName = this.dataset.plantName;
                        const size = this.dataset.size;
                        const price = parseFloat(this.dataset.price);
                        const sizeIndex = parseInt(this.dataset.sizeIndex);
                        
                        console.log('Adding to cart:', {plantId, plantName, size, price, sizeIndex});
                        addToCart(plantId, plantName, size, price, sizeIndex);
                    } catch (error) {
                        console.error('Error adding to cart:', error);
                        alert('Error adding item to cart. Please try again.');
                    }
                });
            });
        }

        function loadCategoryData(category) {
            currentCategory = category;
            const data = plantData[category];
            
            if (data) {
                // Store original data for search/filter functionality
                originalCategoryData[category] = data;
                
                // Reset search and sort state
                const searchBox = document.getElementById(`${category}-search`);
                if (searchBox) searchBox.value = '';
                
                // Reset sort buttons
                const buttons = document.querySelectorAll(`#${category}-page .sort-btn`);
                buttons.forEach(btn => btn.classList.remove('active'));
                const cloneBtn = document.querySelector(`#${category}-page .sort-btn[onclick*="clone"]`);
                if (cloneBtn) cloneBtn.classList.add('active');
                
                // Set default sort
                currentSort[category] = 'clone';
                const sortedData = applySortToData(data, 'clone');
                
                // Update results count
                const countElement = document.getElementById(`${category}-count`);
                if (countElement) {
                    countElement.textContent = `${data.length} plants`;
                }
                
                renderPlantGrid(category, sortedData);
            }
        }

        // Render plants
        function renderPlants(plants, category) {
            const grid = document.getElementById(category + '-grid');
            if (!grid) return;

            grid.innerHTML = plants.map(plant => createPlantCard(plant)).join('');

            // Handle image loading errors
            grid.querySelectorAll('.plant-image img').forEach(img => {
                img.addEventListener('error', function() {
                    this.style.display = 'none';
                    this.parentElement.classList.add('placeholder');
                    const icon = getPlantIcon(plants.find(p => p.id === this.closest('.plant-card').querySelector('.plant-id').textContent)?.variety || category);
                    this.parentElement.innerHTML = `<span style="font-size: 4rem; color: white;">${icon}</span>`;
                });
            });

            // Add click event listeners for image modal (Safari-compatible)
            grid.querySelectorAll('.clickable-image').forEach((img, index) => {
                console.log('Adding click listener to image', index, img.src, img.dataset);
                
                // Try multiple event binding approaches for Safari compatibility
                img.style.cursor = 'pointer';
                img.addEventListener('click', function(e) {
                    console.log('Image clicked!', this.dataset.imageSrc, this.dataset.plantName);
                    e.preventDefault();
                    e.stopPropagation();
                    const imageSrc = this.dataset.imageSrc;
                    const plantName = this.dataset.plantName;
                    if (imageSrc && plantName) {
                        openImageModal(imageSrc, plantName);
                    } else {
                        console.error('Missing image data:', {imageSrc, plantName});
                    }
                });
                
                // Alternative approach using mousedown for Safari
                img.addEventListener('mousedown', function(e) {
                    console.log('Image mousedown!', this.dataset.imageSrc);
                });
                
                // Touch events for mobile Safari
                img.addEventListener('touchstart', function(e) {
                    console.log('Image touch!', this.dataset.imageSrc);
                    e.preventDefault();
                    const imageSrc = this.dataset.imageSrc;
                    const plantName = this.dataset.plantName;
                    if (imageSrc && plantName) {
                        openImageModal(imageSrc, plantName);
                    }
                });
            });

            // Add event listeners for add to cart buttons
            grid.querySelectorAll('.add-to-cart-btn').forEach(button => {
                button.addEventListener('click', function() {
                    try {
                        if (this.disabled) return;
                        
                        const plantId = this.dataset.plantId;
                        const plantName = this.dataset.plantName;
                        const size = this.dataset.size;
                        const price = parseFloat(this.dataset.price);
                        const sizeIndex = parseInt(this.dataset.sizeIndex);
                        
                        console.log('Adding to cart:', {plantId, plantName, size, price, sizeIndex});
                        addToCart(plantId, plantName, size, price, sizeIndex);
                    } catch (error) {
                        console.error('Error adding to cart:', error);
                        alert('Error adding item to cart. Please try again.');
                    }
                });
            });
        }

        // Create plant card HTML
        function createPlantCard(plant) {
            const pricesHTML = plant.prices.map((priceOption, index) => `
                <div class="price-option">
                    <div class="price-info">
                        <span>${priceOption.size}</span>
                        <span style="font-weight: bold; font-size: 1.2rem;">$${priceOption.price}</span>
                    </div>
                    <button class="add-to-cart-btn" 
                            data-plant-id="${plant.id}" 
                            data-plant-name="${plant.name}" 
                            data-size="${priceOption.size}" 
                            data-price="${priceOption.price}" 
                            data-size-index="${index}"
                            ${plant.availability !== 'available' ? 'disabled' : ''}>
                        ${plant.availability === 'available' ? 'Add to Cart' : 'Sold Out'}
                    </button>
                </div>
            `).join('');

            const featuresHTML = plant.features.map(feature => 
                `<span class="feature-tag">${feature}</span>`
            ).join('');

            const imageHTML = plant.image ? 
                `<img src="${plant.image}" alt="${plant.name}" loading="lazy" class="clickable-image" data-image-src="${plant.image}" data-plant-name="${plant.name.replace(/"/g, '&quot;')}" title="Click to view full size">` :
                `<span style="font-size: 4rem; color: white;">${getPlantIcon(plant.variety)}</span>`;

            return `
                <div class="plant-card">
                    <div class="plant-image ${plant.image ? '' : 'placeholder'}" ${plant.image ? `onclick="openImageModal('${plant.image}', '${plant.name.replace(/'/g, '\\\'')}')" style="cursor: pointer;" title="Click to view full size"` : ''}>
                        ${imageHTML}
                        <div class="status-badge status-${plant.status}">${plant.status.replace('-', ' ')}</div>
                    </div>
                    <div class="plant-info">
                        <div class="plant-id">${plant.id}</div>
                        <h3 class="plant-name">${plant.name}</h3>
                        <p class="plant-location">${plant.location}</p>
                        <p class="plant-description">${plant.description}</p>
                        <div class="plant-features">
                            ${featuresHTML}
                        </div>
                        <div class="plant-pricing">
                            <div class="price-options">
                                ${pricesHTML}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Get plant icon
        function getPlantIcon(variety) {
            const iconMap = {
                'flavas': '🌿',
                'leucophyllas': '🏺', 
                'hybrids': '🌸',
                'alata': '🪴',
                'psittacina': '🦜',
                'oreophila': '⛰️',
                'rubra': '🌹',
                'venus-flytraps': '🦷',
                'utricularia': '🫧',
                'cephalotus': '🏺',
                'darlingtonia': '🐍',
                'companion-plants': '🌺',
                'purpureas': '💜',
                'minors': '🔍',
                'rubricorpora': '🌿',
                'rugelii': '🌿',
                'ornata': '🌿',
                'atropurpurea': '🌿',
                'maxima': '🌿',
                'cuprea': '🌿',
                'moorei': '🌸',
                'cultivar': '🌸'
            };
            return iconMap[variety] || '🌿';
        }

        // Helper function to get plant location by ID
        function getPlantLocation(plantId) {
            // Search through all categories in plantData
            for (const category in plantData) {
                const plant = plantData[category].find(p => p.id === plantId);
                if (plant) {
                    return plant.location || '';
                }
            }
            return '';
        }

        // Cart functionality
        function addToCart(plantId, plantName, size, price, sizeIndex) {
            const existingItemIndex = cart.findIndex(item => 
                item.id === plantId && item.sizeIndex === sizeIndex
            );
            
            if (existingItemIndex >= 0) {
                cart[existingItemIndex].quantity += 1;
            } else {
                cart.push({
                    id: plantId,
                    name: plantName,
                    size: size,
                    price: price,
                    sizeIndex: sizeIndex,
                    quantity: 1
                });
            }
            
            localStorage.setItem('mikeWangCart', JSON.stringify(cart));
            updateCartIcon();
            showCartNotification(plantName);
        }

        function removeFromCart(plantId, sizeIndex) {
            cart = cart.filter(item => !(item.id === plantId && item.sizeIndex === sizeIndex));
            localStorage.setItem('mikeWangCart', JSON.stringify(cart));
            updateCartIcon();
            if (currentPage === 'cart') {
                showCart();
            }
        }

        function updateCartQuantity(plantId, sizeIndex, newQuantity) {
            const itemIndex = cart.findIndex(item => 
                item.id === plantId && item.sizeIndex === sizeIndex
            );
            
            if (itemIndex >= 0) {
                if (newQuantity <= 0) {
                    removeFromCart(plantId, sizeIndex);
                } else {
                    cart[itemIndex].quantity = newQuantity;
                    localStorage.setItem('mikeWangCart', JSON.stringify(cart));
                    updateCartIcon();
                    if (currentPage === 'cart') {
                        showCart();
                    }
                }
            }
        }

        function updateCartIcon() {
            const cartCount = document.getElementById('cart-count');
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            
            if (totalItems > 0) {
                cartCount.textContent = totalItems;
                cartCount.style.display = 'block';
            } else {
                cartCount.style.display = 'none';
            }
        }

        function showCartNotification(plantName) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #7cb342;
                color: white;
                padding: 1rem;
                border-radius: 5px;
                z-index: 10001;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            `;
            notification.textContent = `Added ${plantName} to cart!`;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function showCart() {
            // Update current page
            currentPage = 'cart';
            
            // Hide all other pages
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Update nav active states
            document.querySelectorAll('nav a').forEach(link => {
                link.classList.remove('active');
            });
            
            // Show cart page
            document.getElementById('cart-page').classList.add('active');
            
            // Render cart items
            renderCartItems();
        }

        function renderCartItems() {
            const cartItemsContainer = document.getElementById('cart-items');
            const cartEmpty = document.getElementById('cart-empty');
            const cartSummary = document.getElementById('cart-summary');
            
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '';
                cartEmpty.style.display = 'block';
                cartSummary.style.display = 'none';
                return;
            }
            
            cartEmpty.style.display = 'none';
            cartSummary.style.display = 'block';
            
            const cartHTML = cart.map(item => `
                <div class="cart-item">
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-size">${item.size} - $${item.price}</div>
                    </div>
                    <div class="cart-item-controls">
                        <div class="quantity-controls">
                            <button class="quantity-btn" onclick="updateCartQuantity('${item.id}', ${item.sizeIndex}, ${item.quantity - 1})">-</button>
                            <span class="quantity">${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateCartQuantity('${item.id}', ${item.sizeIndex}, ${item.quantity + 1})">+</button>
                        </div>
                        <button style="background: #dc3545; color: white; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer;" 
                                onclick="removeFromCart('${item.id}', ${item.sizeIndex})">Remove</button>
                    </div>
                </div>
            `).join('');
            
            cartItemsContainer.innerHTML = cartHTML;
            
            // Calculate totals
            updateCartTotals();
            
            // Set up checkbox listener
            const checkbox = document.getElementById('bare-root-checkbox');
            const checkoutButton = document.getElementById('checkout-button');
            
            if (checkbox && checkoutButton) {
                checkbox.addEventListener('change', function() {
                    checkoutButton.disabled = !this.checked;
                    if (this.checked) {
                        checkoutButton.style.opacity = '1';
                        checkoutButton.style.cursor = 'pointer';
                    } else {
                        checkoutButton.style.opacity = '0.5';
                        checkoutButton.style.cursor = 'not-allowed';
                    }
                });
            }
        }

        function updateCartTotals() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const taxRate = 0.1025; // CA sales tax rate 10.25%
            const tax = subtotal * taxRate;
            const total = subtotal + tax;
            
            document.getElementById('cart-subtotal').textContent = subtotal.toFixed(2);
            document.getElementById('cart-tax').textContent = tax.toFixed(2);
            document.getElementById('cart-total-amount').textContent = total.toFixed(2);
            
            // Update tax label to clarify CA only
            document.getElementById('tax-label').textContent = 'CA Sales Tax (10.25%):';
        }

        function showOrderForm() {
            // Check if bare root checkbox is checked
            const bareRootCheckbox = document.getElementById('bare-root-checkbox');
            if (!bareRootCheckbox || !bareRootCheckbox.checked) {
                alert('Please acknowledge that you understand all plants are shipped bare root before proceeding.');
                return;
            }

            // Hide all other pages
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show order form page
            document.getElementById('order-form-page').classList.add('active');
            currentPage = 'order-form';
            
            // Populate order summary
            populateOrderSummary();
            
            // Set up form submission
            setupOrderForm();
        }

        function populateOrderSummary() {
            const orderItems = cart.map(item => `
                <div class="order-item-review">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>${item.name}</strong><br>
                            <span style="color: #666;">${item.size}</span>
                        </div>
                        <div style="text-align: right;">
                            <div>Qty: ${item.quantity}</div>
                            <div style="font-weight: bold;">$${(item.price * item.quantity).toFixed(2)}</div>
                        </div>
                    </div>
                </div>
            `).join('');
            
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const taxRate = 0.1025;
            const tax = subtotal * taxRate;
            const estimatedTotal = subtotal + tax;
            
            const totalsHTML = `
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Subtotal:</span>
                    <span>$${subtotal.toFixed(2)}</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>CA Sales Tax (10.25%):</span>
                    <span>$${tax.toFixed(2)}</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Shipping:</span>
                    <span>TBD ($11-$40)</span>
                </div>
                <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 1.1rem; border-top: 1px solid #ddd; padding-top: 0.5rem; margin-top: 0.5rem;">
                    <span>Estimated Total (before shipping):</span>
                    <span>$${estimatedTotal.toFixed(2)}</span>
                </div>
            `;
            
            document.getElementById('order-items-review').innerHTML = orderItems;
            document.getElementById('order-totals-review').innerHTML = totalsHTML;
        }

        function setupOrderForm() {
            const form = document.getElementById('order-form');
            form.onsubmit = function(e) {
                e.preventDefault();
                
                const formData = new FormData(form);
                const customerData = {
                    name: formData.get('name'),
                    email: formData.get('email'),
                    phone: formData.get('phone'),
                    address: formData.get('address'),
                    payment: formData.get('payment'),
                    notes: formData.get('notes')
                };
                
                submitOrderRequest(customerData);
            };
        }

        // Function to decode HTML entities
        function decodeHtmlEntities(text) {
            const textarea = document.createElement('textarea');
            textarea.innerHTML = text;
            return textarea.value;
        }

        async function submitOrderRequest(customerData) {
            // Show loading state
            const submitButton = document.querySelector('.submit-order-btn');
            const originalText = submitButton.textContent;
            submitButton.textContent = 'Submitting Order...';
            submitButton.disabled = true;

            try {
                // Create order summary with ID and location
                const orderItems = cart.map(item => {
                    const location = getPlantLocation(item.id);
                    return `[${item.id}] ${item.name}${location ? ` - Location: ${location}` : ''} (${item.size}) - Qty: ${item.quantity} - $${(item.price * item.quantity).toFixed(2)}`;
                }).join('\n');
                
                const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                const taxRate = 0.1025;
                const tax = subtotal * taxRate;
                const estimatedTotal = subtotal + tax;
                
                // Check if Google Forms is configured
                if (GOOGLE_FORMS_CONFIG.FORM_URL === 'YOUR_GOOGLE_FORM_URL') {
                    // Fallback to mailto if Google Forms not configured
                    const emailBody = `Hi Mike,

I would like to place an order for the following plants:

CUSTOMER INFORMATION:
Name: ${customerData.name}
Email: ${customerData.email}
Phone: ${customerData.phone || 'Not provided'}
Shipping Address:
${customerData.address || 'Not provided - shipping quote requested'}

PREFERRED PAYMENT METHOD: ${customerData.payment || 'Not specified'}

ORDER DETAILS:
${orderItems}

COST BREAKDOWN:
Subtotal: $${subtotal.toFixed(2)}
CA Sales Tax (10.25%): $${tax.toFixed(2)}
Shipping: TBD ($11-$40 depending on order size/location)
Estimated Total (before shipping): $${estimatedTotal.toFixed(2)}

TAX NOTE: CA sales tax (10.25%) shown above applies only to California deliveries. 
Out-of-state orders are tax-free - deduct $${tax.toFixed(2)} if shipping outside CA.

SHIPPING ACKNOWLEDGMENT:
✓ I understand that all plants are shipped bare root
✓ I understand that plants may appear dormant/stressed upon arrival
✓ I understand this is normal for bare root shipping

${customerData.notes ? `ADDITIONAL NOTES:\n${customerData.notes}\n\n` : ''}Please confirm the final shipping cost and provide payment details.

Thank you!`;
                    
                    const emailSubject = `Plant Order Request - ${customerData.name} - Est. $${estimatedTotal.toFixed(2)}`;
                    const mailtoLink = `mailto:meizzwang@gmail.com?subject=${encodeURIComponent(emailSubject)}&body=${encodeURIComponent(emailBody)}`;
                    
                    window.location.href = mailtoLink;
                    alert('Google Forms not configured yet. Opening email client as fallback.');
                    
                } else {
                    // Check for missing email field
                    if (GOOGLE_FORMS_CONFIG.FIELDS.customer_email === 'entry.NEEDS_TO_BE_ADDED') {
                        alert('Google Form setup incomplete: Customer Email field needs to be added to the form. Using email fallback.');
                        
                        // Use mailto fallback
                        const emailBody = `Hi Mike,

I would like to place an order for the following plants:

CUSTOMER INFORMATION:
Name: ${customerData.name}
Email: ${customerData.email}
Phone: ${customerData.phone || 'Not provided'}
Shipping Address:
${customerData.address || 'Not provided - shipping quote requested'}

PREFERRED PAYMENT METHOD: ${customerData.payment || 'Not specified'}

ORDER DETAILS:
${orderItems}

COST BREAKDOWN:
Subtotal: $${subtotal.toFixed(2)}
CA Sales Tax (10.25%): $${tax.toFixed(2)}
Shipping: TBD ($11-$40 depending on order size/location)
Estimated Total (before shipping): $${estimatedTotal.toFixed(2)}

TAX NOTE: CA sales tax (10.25%) shown above applies only to California deliveries. 
Out-of-state orders are tax-free - deduct $${tax.toFixed(2)} if shipping outside CA.

SHIPPING ACKNOWLEDGMENT:
✓ I understand that all plants are shipped bare root
✓ I understand that plants may appear dormant/stressed upon arrival
✓ I understand this is normal for bare root shipping

${customerData.notes ? `ADDITIONAL NOTES:\n${customerData.notes}\n\n` : ''}Please confirm the final shipping cost and provide payment details.

Thank you!`;
                        
                        const emailSubject = `Plant Order Request - ${customerData.name} - Est. $${estimatedTotal.toFixed(2)}`;
                        const mailtoLink = `mailto:meizzwang@gmail.com?subject=${encodeURIComponent(emailSubject)}&body=${encodeURIComponent(emailBody)}`;
                        
                        window.location.href = mailtoLink;
                        return;
                    }
                    
                    // Submit to Google Forms
                    const formData = new FormData();
                    
                    console.log('Submitting to Google Forms with data:', {
                        name: customerData.name,
                        email: customerData.email,
                        formUrl: GOOGLE_FORMS_CONFIG.FORM_URL
                    });
                    
                    // Add all form fields
                    formData.append(GOOGLE_FORMS_CONFIG.FIELDS.customer_name, customerData.name);
                    formData.append(GOOGLE_FORMS_CONFIG.FIELDS.customer_email, customerData.email);
                    formData.append(GOOGLE_FORMS_CONFIG.FIELDS.customer_phone, customerData.phone || 'Not provided');
                    formData.append(GOOGLE_FORMS_CONFIG.FIELDS.shipping_address, customerData.address || 'Not provided - shipping quote requested');
                    formData.append(GOOGLE_FORMS_CONFIG.FIELDS.preferred_payment, customerData.payment || 'Not specified');
                    formData.append(GOOGLE_FORMS_CONFIG.FIELDS.order_items, orderItems);
                    formData.append(GOOGLE_FORMS_CONFIG.FIELDS.subtotal, subtotal.toFixed(2));
                    formData.append(GOOGLE_FORMS_CONFIG.FIELDS.tax_amount, tax.toFixed(2));
                    formData.append(GOOGLE_FORMS_CONFIG.FIELDS.estimated_total, estimatedTotal.toFixed(2));
                    formData.append(GOOGLE_FORMS_CONFIG.FIELDS.additional_notes, customerData.notes || 'None');
                    
                    // Try iframe submission method (more reliable for Google Forms)
                    try {
                        // Create a hidden iframe for form submission
                        const iframe = document.createElement('iframe');
                        iframe.style.display = 'none';
                        iframe.name = 'hidden_iframe';
                        document.body.appendChild(iframe);
                        
                        // Create a temporary form
                        const tempForm = document.createElement('form');
                        tempForm.method = 'POST';
                        tempForm.action = GOOGLE_FORMS_CONFIG.FORM_URL;
                        tempForm.target = 'hidden_iframe';
                        
                        // Add all fields as hidden inputs
                        Object.keys(GOOGLE_FORMS_CONFIG.FIELDS).forEach(key => {
                            const input = document.createElement('input');
                            input.type = 'hidden';
                            input.name = GOOGLE_FORMS_CONFIG.FIELDS[key];
                            
                            switch(key) {
                                case 'customer_name':
                                    input.value = customerData.name || '';
                                    break;
                                case 'customer_email':
                                    input.value = customerData.email || '';
                                    break;
                                case 'customer_phone':
                                    input.value = customerData.phone || 'Not provided';
                                    break;
                                case 'shipping_address':
                                    input.value = customerData.address || '';
                                    break;
                                case 'preferred_payment':
                                    input.value = customerData.payment || 'Not specified';
                                    break;
                                case 'order_items':
                                    input.value = orderItems;
                                    break;
                                case 'subtotal':
                                    input.value = subtotal.toFixed(2);
                                    break;
                                case 'tax_amount':
                                    input.value = tax.toFixed(2);
                                    break;
                                case 'estimated_total':
                                    input.value = estimatedTotal.toFixed(2);
                                    break;
                                case 'additional_notes':
                                    input.value = customerData.notes || 'None';
                                    break;
                            }
                            tempForm.appendChild(input);
                        });
                        
                        document.body.appendChild(tempForm);
                        
                        console.log('Submitting to Google Forms via iframe method');
                        tempForm.submit();
                        
                        // Clean up after submission
                        setTimeout(() => {
                            document.body.removeChild(tempForm);
                            document.body.removeChild(iframe);
                        }, 1000);
                        
                        console.log('Google Forms submission completed via iframe');
                        
                        // Show success message
                        alert(`Order request submitted successfully! 

Your order for $${estimatedTotal.toFixed(2)} (before shipping) has been sent to Mike.

Mike will receive an automatic notification and will contact you at ${customerData.email} with shipping details and payment instructions.

Thank you for your order!`);
                        
                    } catch (error) {
                        console.error('Google Forms submission failed:', error);
                        throw error; // This will trigger the catch block below
                    }
                }
                
                // Clear cart and return to home
                cart = [];
                localStorage.setItem('mikeWangCart', JSON.stringify(cart));
                updateCartIcon();
                navigateTo('home');
                
            } catch (error) {
                console.error('Error submitting order:', error);
                
                // Fallback to mailto on error
                const emailBody = `Hi Mike,

I would like to place an order for the following plants:

CUSTOMER INFORMATION:
Name: ${customerData.name}
Email: ${customerData.email}
Phone: ${customerData.phone || 'Not provided'}
Shipping Address:
${customerData.address || 'Not provided - shipping quote requested'}

PREFERRED PAYMENT METHOD: ${customerData.payment || 'Not specified'}

ORDER DETAILS:
${cart.map(item => {
    const location = getPlantLocation(item.id);
    return `[${item.id}] ${item.name}${location ? ` - Location: ${location}` : ''} (${item.size}) - Qty: ${item.quantity} - $${(item.price * item.quantity).toFixed(2)}`;
}).join('\n')}

Please confirm pricing and shipping details.

Thank you!`;
                
                const emailSubject = `Plant Order Request - ${customerData.name}`;
                const mailtoLink = `mailto:meizzwang@gmail.com?subject=${encodeURIComponent(emailSubject)}&body=${encodeURIComponent(emailBody)}`;
                
                window.location.href = mailtoLink;
                alert('There was an error submitting the order. Opening your email client as backup.');
                
            } finally {
                // Reset button state
                submitButton.textContent = originalText;
                submitButton.disabled = false;
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', initializePlantData);

        // Handle browser back/forward
        window.addEventListener('hashchange', function() {
            const page = window.location.hash.substring(1) || 'home';
            if (page === 'cart') {
                showCart();
            } else {
                navigateTo(page);
            }
        });

        // Initialize from URL hash
        window.addEventListener('load', function() {
            const page = window.location.hash.substring(1) || 'home';
            if (page === 'cart') {
                showCart();
            } else if (page !== 'home') {
                navigateTo(page);
            }
        });
    </script>
</body>
</html>